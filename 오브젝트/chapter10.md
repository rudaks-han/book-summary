# 10장 상속과 코드 재사용

## 01 상속과 중복 코드

### DRY 원칙

* 중복 코드는 변경을 바앻한다.
* 이것이 중복 코드를 제거해야 하는 가장 큰 이유다.
* 중복 코드가 가지는 가장 큰 문제는 코드를 수정하는 데 필요한 노력을 몇 배로 증가시킨다는 것이다.
* 중복 여부를 판단하는 기준은 변경이다.
    * 요구사항이 변경됐을 때 두 코드를 함께 수정해야 한다면 이 코드는 중복이다.
    * 함께 수정할 필요가 없다면 중복이 아니다.
* DRY는 '반복하지 마라'라는 뜻의 Don't Repeat Yourself의 첫 글자를 모아 만든 용어로 동일한 지식을 중복하지 말라는 것이다.
* DRY 원칙은 한 번, 단 한번(Once and Only Once)원칙 또는 단일 지점 제어 원칙이라고도 부른다.



### 중복과 변경





### 상속을 이용해서 중복 코드 제거하기





### 강하게 결합된 Phone과 NightlyDiscountPhone





## 02 취약한 기반 클래스 문제

* 부모 클래스의 변경에 의해 자식 클래스가 영향을 받는 현상을 **취약한 기반 클래스 문제(Fragile Base Class Problem, Brittle Base Class Problem)**라고 부른다.
* 이 문제는 상속을 사용한다면 피할 수 없는 객체지향 프로그래밍의 근본적인 취약성이다.
* 상속 관계를 추가할수록 시스템의 결합도가 높아진다는 사실을 알고 있어야 한다.
* 상속은 자식 클래스를 점진적으로 추가해서 기능을 확장하는 데는 용이하지만 높은 결합도로 인해 부모 클래스를 점진적으로 개선하는 것은 어렵게 만든다.
* 상속은 자식 클래스가 부모 클래스의 구현 세부사항에 의존하도록 만들기 때문에 캡슐화를 약화시킨다.
* 이것이 상속이 위험한 이유인 동시에 우리가 상속을 피해야 하는 첫 번째 이유다.
* 안타깝게도 상속을 사용하면 부모 클래스의 퍼블릭 인터페이스가 아닌 구현을 변경하더라도 자식 클래스가 영향을 받기 쉬워진다.
* 상속 계층의 상위에 위치한 클래스에 가해지는 작은 병경만으로도 상속 계층에 속한 모든 자손들이 급격하게 요동칠 수 있다.



### 불필요한 인터페이스 상속 문제





### 메서드 오버라이딩의 오작용 문제





### 부모 클래스와 자식 클래스의 동시 수정 문제





## 03 Phone 다시 살펴보기

### 추상화에 의존하자

* NightlyDiscountPhone의 가장 큰 문제점은 Phone에 강하게 결합돼 있기 때문에 Phone이 변경될 경우 함께 변경될 가능성이 높다는 것이다.
* 이 문제를 해결하는 가장 일반적인 방법은 자식 클래스가 부모 클래스의 구현이 아닌 추상화에 의존하도록 만드는 것이다.
* 개인적으로 코드 중복을 제거하기 위해 상속을 도입할 때 따르는 두 가지 원칙이 있다.
    * 두 메서드가 유사하게 보인다면 차이점을 메서드로 추출하라. 메서드 추출을 통해 두 메시더를 동일한 형태로 보이도록 만들 수 있다.
    * 부모 클래스의 코드를 하위로 내리지 말고 자식 클래스의 코드를 상위로 올려라. 



### 차이를 메서드로 추출하라





### 중복 코드를 부모 클래스로 올려라





### 추상화가 핵심이다

* 공통 코드를 이동시킨 후에 각 클래스는 서로 다른 변경의 이유를 가진다는 것에 주목하라.
* 단일 책임 원칙을 준수하기 때문에 응집도가 높다.
* 새로운 요금제를 추가하기도 쉽다는 사실 역시 주목하라.
* 계방-폐쇄 원칙 역시 준수한다.



### 의도를 드러내는 이름 개선하기





## 04 차이에 의한 프로그래밍

