# 11장 합성과 유연한 설계

## 01 상속을 합성으로 변경하기

* 상속이 부모 클래스와 자식 클래스를 연결해서 부모 클래스의 코드를 재사용하는 데 비해
* 합성은 전체를 표현한느 객체가 부분을 표현하는 객체를 포함해서 부분 객체의 코드를 재사용한다.
* 상속 관계는 is-a 관계라고 부르고 합성 관계는 has-a 관계라 부른다.
* 상속을 이용하면 부모 클래스의 코드를 재사용할 수 있게 된다.
    * 그러나 상속을 제대로 활용하기 위해서는 부모 클래스의 내부 구현에 대해 상세하게 알아야 하기 때문에 자식 클래스와 부모 클래스 사이의 결합도가 높아질 수밖에 없다.
    * 결과적으로 상속은 코드를 재사용할 수 있는 쉽고 간단한 방법일지는 몰라도 우아한 방법이라고 할 수는 없다.
* 합성은 구현에 의존하지 않는 점에서 상속과 다르다.
    * 합성은 내부에 포함되는 객체의 구현이 아닌 퍼블릭 인터페이스에 의존한다.
    * 따라서 합성을 이용하면 포함된 객체의 내부 구현이 변경되더라도 영향을 최소화할 수 있기 때문에 더 안정적인 코드를 얻을 수 있게 된다.
* 상속 관계는 클래스 사이의 정적인 관계인 데 비해 합성 관계는 객체 사이의 동적인 관계다.
* 코드 작성 시점에 결정한 상속 관계는 불가능하지만 합성 관계는 실행 시점에 동적으로 변경할 수 있기 때문이다.

> [코드 재사용을 위해서는] 객체 합성이 클래스 상속보다 더 좋은 방법이다.

* 상속은 합성과 재사용의 대상이 다르다.
* 상속은 부모 클래스 안에 구현된 코드 자체를 재사용하지만 합성은 포함되는 객체의 인터페이스를 재사용한다.



### 불필요한 인터페이스 상속 문제: java.util.Properties와 java.util.Stack





### 메서드 오버라이딩의 오작용 문제: InstrumentedHashSet





### 부모 클래스와 자식 클래스의 동시 수정 문제: PersonalPlaylist





## 02 상속으로 인한 조합의 폭발적인 증가





### 기본 정책과 부가 정책 조합하기





### 상속을 이용해서 기본 정책 구현하기





### 기본 정책에 세금 정책 조합하기





### 기본 정책에 기본 요금 할인 정책 조합하기





### 중복 코드와 덫에 걸리다





## 03 합성 관계로 변경하기





### 기본 정책 합성하기





### 부가 정책 적용하기





### 기본 정책과 부가 정책 합성하기





### 새로운 정책 추가하기





### 객체 합성이 클래스 상속보다 더 좋은 방법이다





## 04 믹스인





### 기본 정책 구현하기





### 트레이트로 부가 정책 구현하기





### 부가 정책 트레이트 믹스인하기





### 쌓을 수 있는 변경





